<!doctype html>
<html>
 <head>
  <script type="text/javascript" src="html2canvas.js"></script>
  <script type="text/javascript" src="canvas2image.js"></script>
 </head>
 <body>
  <canvas style="display: none;"  id="canvas"></canvas>
 <h1 id="hy">Hello im taking screenshot</h1>
  <input type='button' id='but_screenshot' value='Take screenshot' onclick='capture();'><br/><!--onclick='screenshot();'><br/>-->
  <a id="save" href="donload.png" >donload</a>
  <img id="pic" src="" alt="">
  <img id="pic2" src="" alt="">
  <input id="abc" type="file" onchange="indata(event)" accept="image/png, image/jpeg">
  <!-- Script -->
  <!-- Script -->
  <script type='text/javascript'>
   /* function indata(event){
      document.getElementById('pic').src=URL.createObjectURL(event.target.files[0]);
      document.getElementById('save').href='mailto:kabeloref@gmail.com?body=aaa?body='+document.getElementById('pic').src+'?';
    }
    function screenshot(){
      html2canvas(document.body).then(function(canvas) {
      //document.body.appendChild(canvas);
      document.getElementById('save').href='mailto:kabeloref@gmail.com?body=aaa?body='+canvas.toDataURL('png')+'?';
      document.getElementById('hy').innerHTML =  canvas.toDataURL('png');
      document.getElementById('pic2').src=canvas.toDataURL('png');
      document.getElementById('save').download = Date() ;
      return Canvas2Image.saveAsPNG(canvas);
     });
    }*/

    function debugBase64(base64URL){
    var win = window.open();
    win.document.write('<iframe src="' + base64URL  + '" frameborder="0" style="border:0; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%;" allowfullscreen></iframe>');
}
    const capture = async () => {
navigator.mediaDevices.getDisplayMedia().then(stream => 
{
  let track = stream.getVideoTracks()[0];
  let capture = new ImageCapture(track);
  capture.grabFrame().then(bitmap => 
  {
    track.stop();
    canvas.width = bitmap.width;
    canvas.height = bitmap.height;
    canvas.getContext('2d').drawImage(bitmap, 0, 0);
    return Canvas2Image.saveAsPNG(canvas); 
  });
})
.catch(e => console.log(e));
};
    </script>

 </body>
</html>